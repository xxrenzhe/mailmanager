
<!DOCTYPE html>
<html>
<head>
    <title>Outlook é‡æ–°æˆæƒURLç”Ÿæˆå™¨</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .input-group { margin: 10px 0; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
        button { background: #0078d4; color: white; padding: 10px 20px; border: none; cursor: pointer; margin: 5px; }
        button:hover { background: #106ebe; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .copy-btn { background: #28a745; }
        .copy-btn:hover { background: #218838; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Outlook é‡æ–°æˆæƒURLç”Ÿæˆå™¨</h1>

    <div class="input-group">
        <label>é‚®ç®±åœ°å€ (æ¯è¡Œä¸€ä¸ª):</label>
        <textarea id="emails" rows="10" placeholder="user1@outlook.com&#10;user2@outlook.com&#10;user3@outlook.com"></textarea>
    </div>

    <div class="input-group">
        <label>Client ID:</label>
        <input type="text" id="clientId" value="ä½ çš„å®¢æˆ·ç«¯ID">
    </div>

    <div class="input-group">
        <label>Redirect URI:</label>
        <input type="text" id="redirectUri" value="http://localhost:3000/auth/callback">
    </div>

    <button onclick="generateUrls()">ç”ŸæˆæˆæƒURL</button>
    <button onclick="clearAll()">æ¸…ç©º</button>

    <div id="results"></div>

    <script>
        function generateUrls() {
            const emails = document.getElementById('emails').value.split('\n').filter(email => email.trim());
            const clientId = document.getElementById('clientId').value;
            const redirectUri = document.getElementById('redirectUri').value;
            const scope = 'https://outlook.office.com/Mail.Read';

            let results = '<h2>ğŸ“‹ ç”Ÿæˆçš„æˆæƒURLåˆ—è¡¨</h2>';

            emails.forEach((email, index) => {
                const state = btoa(JSON.stringify({
                    accountId: index + 1,
                    email: email.trim(),
                    timestamp: Date.now()
                }));

                const authUrl = `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?` +
                    `client_id=${clientId}&` +
                    `response_type=code&` +
                    `redirect_uri=${encodeURIComponent(redirectUri)}&` +
                    `scope=${encodeURIComponent(scope)}&` +
                    `state=${state}`;

                results += `
                    <div class="result">
                        <h3>${index + 1}. ${email}</h3>
                        <p><strong>æˆæƒURL:</strong></p>
                        <input type="text" value="${authUrl}" readonly>
                        <button class="copy-btn" onclick="copyToClipboard('${authUrl}')">å¤åˆ¶URL</button>
                        <button onclick="openAuth('${authUrl}')">æ‰“å¼€æˆæƒé¡µé¢</button>
                    </div>
                `;
            });

            document.getElementById('results').innerHTML = results;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('URLå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }

        function openAuth(url) {
            window.open(url, '_blank');
        }

        function clearAll() {
            document.getElementById('emails').value = '';
            document.getElementById('results').innerHTML = '';
        }
    </script>
</body>
</html>