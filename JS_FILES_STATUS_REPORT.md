# JavaScriptæ–‡ä»¶çŠ¶æ€æ£€æŸ¥æŠ¥å‘Š

## ğŸ“‹ æ£€æŸ¥æ¦‚è§ˆ

**æ£€æŸ¥æ—¶é—´**: 2024-08-15
**æ£€æŸ¥èŒƒå›´**: æ‰€æœ‰JavaScriptæ–‡ä»¶ï¼ˆ.jsï¼‰
**æ£€æŸ¥é¡¹ç›®**: è¯­æ³•é”™è¯¯ã€è¿è¡Œæ—¶é”™è¯¯ã€é…ç½®å†²çª

## âœ… è¯­æ³•æ£€æŸ¥ç»“æœ

### proxy-server.js (å·²å¯ç”¨)
- **çŠ¶æ€**: âœ… è¯­æ³•æ­£ç¡®
- **ç«¯å£**: 3001 (HTTP) + 3002 (WebSocket)
- **ä¿®å¤é—®é¢˜**:
  - å­—ç¬¦ç¼–ç é—®é¢˜ (ç¬¬946è¡Œ "éªŒè¯ç " æ˜¾ç¤ºé”™è¯¯)
  - ç¼©è¿›é—®é¢˜ (ç¬¬1038-1085è¡Œ)
- **å½“å‰çŠ¶æ€**: âœ… å¯æ­£å¸¸è¿è¡Œ

### server/ ç›®å½•ä¸‹æ–‡ä»¶
| æ–‡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| `server/index.js` | âœ… è¯­ï¿½ï¿½æ­£ç¡® | ä¸»æœåŠ¡å™¨ï¼Œç«¯å£3000 |
| `server/database.js` | âœ… è¯­æ³•æ­£ç¡® | æ•°æ®åº“æ“ä½œ |
| `server/emailService.js` | âœ… è¯­æ³•æ­£ç¡® | é‚®ä»¶æœåŠ¡ |
| `server/simpleMonitor.js` | âœ… è¯­æ³•æ­£ç¡® | ç›‘æ§æœåŠ¡ |
| `server/advancedVerificationExtractor.js` | âœ… è¯­æ³•æ­£ç¡® | éªŒè¯ç æå– |
| `server/autoReauthService.js` | âœ… è¯­æ³•æ­£ç¡® | è‡ªåŠ¨é‡æ–°æˆæƒ |
| `server/bulkImportQueue.js` | âœ… è¯­æ³•æ­£ç¡® | æ‰¹é‡å¯¼å…¥é˜Ÿåˆ— |
| `server/cacheManager.js` | âœ… è¯­æ³•æ­£ç¡® | ç¼“å­˜ç®¡ç† |
| `server/emailSequenceManager.js` | âœ… è¯­æ³•æ­£ç¡® | é‚®ä»¶åºåˆ—ç®¡ç† |
| `server/errorHandler.js` | âœ… è¯­æ³•æ­£ç¡® | é”™è¯¯å¤„ç† |
| `server/simulatedAuth.js` | âœ… è¯­æ³•æ­£ç¡® | æ¨¡æ‹Ÿæˆæƒ |

### æµ‹è¯•æ–‡ä»¶
| æ–‡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| `test_time_filter.js` | âœ… è¯­æ³•æ­£ç¡® | æ—¶é—´è¿‡æ»¤æµ‹è¯• |
| `test_bulk_import_codes.js` | âœ… è¯­æ³•æ­£ç¡® | æ‰¹é‡å¯¼å…¥æµ‹è¯• |
| `test_email_functionality.js` | âœ… è¯­æ³•æ­£ç¡® | é‚®ä»¶åŠŸèƒ½æµ‹è¯• |
| `test_email_parsing.js` | âœ… è¯­æ³•æ­£ç¡® | é‚®ä»¶è§£ææµ‹è¯• |
| `test_monitoring_timeout.js` | âœ… è¯­æ³•æ­£ç¡® | ç›‘æ§è¶…æ—¶æµ‹è¯• |

### è„šæœ¬æ–‡ä»¶
| æ–‡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| `scripts/cleanup_structure.js` | âœ… è¯­æ³•æ­£ç¡® | ç»“æ„æ¸…ç†è„šæœ¬ |
| `scripts/deploy_kiss.js` | âœ… è¯­æ³•æ­£ç¡® | éƒ¨ç½²è„šæœ¬ |
| `scripts/migrate_to_sqlite.js` | âœ… è¯­æ³•æ­£ç¡® | æ•°æ®åº“è¿ç§»è„šæœ¬ |

## ğŸ” å‘ç°çš„é—®é¢˜

### 1. å·²ä¿®å¤çš„é—®é¢˜

#### proxy-server.js è¯­æ³•é”™è¯¯
- **é—®é¢˜**: ç¬¬946è¡Œå­—ç¬¦ç¼–ç é”™è¯¯
- **è¡¨ç°**: "éªŒè¯ç " æ˜¾ç¤ºä¸º "ï¿½ï¿½ï¿½è¯ç "
- **çŠ¶æ€**: âœ… å·²ä¿®å¤

#### proxy-server.js ç¼©è¿›é”™è¯¯
- **é—®é¢˜**: ç¬¬1038-1085è¡Œä»£ç ç¼©è¿›ä¸æ­£ç¡®
- **è¡¨ç°**: try-catchç»“æ„ä¸åŒ¹é…
- **çŠ¶æ€**: âœ… å·²ä¿®å¤

### 2. é…ç½®è¯´æ˜

#### æœåŠ¡å™¨æ¶æ„
é¡¹ç›®ä¸­å­˜åœ¨ä¸¤ä¸ªæœåŠ¡å™¨ï¼š

1. **proxy-server.js** (å½“å‰å¯ç”¨)
   - ç«¯å£: 3001 (HTTP) + 3002 (WebSocket)
   - åŠŸèƒ½: CORSä»£ç† + é‚®ä»¶ç›‘æ§
   - ç‰¹ç‚¹: çº¯å†…å­˜ï¼Œæ— æ•°æ®åº“

2. **server/index.js** (å¤‡ç”¨)
   - ç«¯å£: 3000
   - åŠŸèƒ½: å®Œæ•´çš„é‚®ä»¶ç®¡ç†ç³»ç»Ÿ
   - ç‰¹ç‚¹: ä½¿ç”¨SQLiteæ•°æ®åº“

#### package.json é…ç½®
```json
{
  "main": "server/index.js",
  "scripts": {
    "dev": "node server/index.js",
    "start": "node server/index.js"
  }
}
```

### 3. å‰ç«¯é…ç½®
- **æ–‡ä»¶**: `simple-mail-manager.html`
- **APIè°ƒç”¨**: ä½¿ç”¨ç›¸å¯¹è·¯å¾„ (å¦‚ `/api/monitor/copy-trigger`)
- **WebSocket**: è¿æ¥åˆ° `ws://localhost:3002`
- **è¯´æ˜**: å‰ç«¯å‡è®¾åç«¯è¿è¡Œåœ¨åŒä¸€åŸŸåçš„æ ¹è·¯å¾„

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. ç«¯å£å†²çªé£é™©
- **proxy-server.js**: 3001 + 3002
- **server/index.js**: 3000
- **å»ºè®®**: ä¸è¦åŒæ—¶è¿è¡Œä¸¤ä¸ªæœåŠ¡å™¨ï¼Œé¿å…ç«¯å£å†²çª

### 2. æ•°æ®ä¸€è‡´æ€§
- **proxy-server.js**: çº¯å†…å­˜ï¼Œé‡å¯åæ•°æ®ä¸¢å¤±
- **server/index.js**: ä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œæ•°æ®æŒä¹…åŒ–
- **å»ºè®®**: æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æœåŠ¡å™¨

### 3. å‰ç«¯é…ç½®
- **ç›¸å¯¹è·¯å¾„API**: å‰ç«¯ä½¿ç”¨ç›¸å¯¹è·¯å¾„è°ƒç”¨åç«¯API
- **é€‚é…éœ€æ±‚**: å¦‚æœåˆ‡æ¢æœåŠ¡å™¨ï¼Œéœ€è¦ç¡®ä¿APIç«¯ç‚¹ä¸€è‡´

## âœ… å½“å‰çŠ¶æ€æ€»ç»“

1. **æ‰€æœ‰JavaScriptæ–‡ä»¶è¯­æ³•æ­£ç¡®** âœ…
2. **proxy-server.js å·²ä¿®å¤æ‰€æœ‰é”™è¯¯** âœ…
3. **ä¸¤ä¸ªæœåŠ¡å™¨éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œ** âœ…
4. **æµ‹è¯•æ–‡ä»¶å‡†å¤‡å°±ç»ª** âœ…

## ğŸ¯ å»ºè®®

1. **å•ä¸€æœåŠ¡å™¨è¿è¡Œ**: åªè¿è¡Œä¸€ä¸ªæœåŠ¡å™¨é¿å…å†²çª
2. **ç¯å¢ƒå˜é‡é…ç½®**: ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ç«¯å£é…ç½®
3. **æ•°æ®å¤‡ä»½**: å¦‚æœä½¿ç”¨proxy-server.jsï¼Œå®šæœŸå¯¼å‡ºé‡è¦æ•°æ®
4. **ç›‘æ§æ—¥å¿—**: å…³æ³¨æœåŠ¡å™¨è¿è¡Œæ—¥å¿—ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

---

**ç»“è®º**: æ‰€æœ‰JavaScriptæ–‡ä»¶éƒ½å·²æ£€æŸ¥å®Œæ¯•ï¼Œæ²¡æœ‰å‘ç°å…¶ä»–é”™è¯¯ã€‚proxy-server.js å·²ä¿®å¤æ‰€æœ‰é—®é¢˜ï¼Œå¯ä»¥æ­£å¸¸å¯ç”¨ã€‚